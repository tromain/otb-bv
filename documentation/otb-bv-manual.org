#+TITLE: Biophysical variable estimation from remote sensing imagery 

* Introduction

* Use
** Input variable generation


*** Variable statistics
|        | Variable         | Minimum | Maximum |   Mode |    Std | Nb_Class | Law   | LAI_Conv |
|--------+------------------+---------+---------+--------+--------+----------+-------+----------|
| Canopy | MLAI             |     0.0 |     8.0 |    2.0 |    2.0 |        6 | gauss |     1000 |
|        | ALA (°)          |      30 |      80 |     60 |     20 |        3 | gauss |       10 |
|        | Crown_Cover      |     1.0 |     1.0 |    0.8 |    0.4 |        1 | uni   |       10 |
|        | HsD              |     0.1 |     0.5 |    0.2 |    0.5 |        1 | gauss |     1000 |
|--------+------------------+---------+---------+--------+--------+----------+-------+----------|
| Leaf   | N                |    1.20 |    1.80 |   1.50 |   0.30 |        3 | gauss |       10 |
|        | Cab (\mu g.m -2) |      20 |      90 |     45 |     30 |        4 | gauss |       10 |
|        | Cdm (g.m-2)      |  0.0030 |  0.0110 | 0.0050 | 0.0050 |        4 | gauss |       10 |
|        | Cw_Rel           |    0.60 |    0.85 |   0.75 |   0.08 |        4 | uni   |       10 |
|        | Cbp              |    0.00 |    2.00 |   0.00 |   0.30 |        3 | gauss |       10 |
|--------+------------------+---------+---------+--------+--------+----------+-------+----------|
| Soil   | Bs               |    0.50 |    3.50 |   1.20 |   2.00 |        4 | gauss |       10 |


**** Prospect OTB
| Nom var OTB      | Description             | var bvnet  |
|------------------+-------------------------+------------|
| double m_Cab;    | //Chlorophyll content   | Cab        |
| double m_Car;    | //Carotenoid content    |            |
| double m_CBrown; | //Brown pigment content | Cbp        |
| double m_Cw;     | //EWT                   | Cw_Rel (?) |
| double m_Cm;     | //LMA                   | Cdm (?)    |
| double m_N;      | //structure coef        | N          |

Cw = Cdm *Cw_Rel/(1-Cw_Rel)
Cdm = Cm
Crown_Cover = not used in SAIL, only useful if GEOSAIL
Car --> not used by bvnet; Féret's dissertation uses Cxc to denote Car
and gives a mean of 8.58 and a std of 3.95 and fig 2.2, p.47 gives the
min at 0 and the max at 25



**** Sail OTB
| Nom var OTB     | Description                | var bvnet |
|-----------------+----------------------------+-----------|
| double m_LAI;   | //leaf area index          | MLAI      |
| double m_Angl;  | //average leaf angle       | ALA       |
| double m_PSoil; | //soil coefficient         | Bs        |
| double m_Skyl;  | //diffuse/direct radiation |           |
| double m_HSpot; | //hot spot                 | HsD       |
| double m_TTS;   | //solar zenith angle       | \theta_s  |
| double m_TTO;   | //observer zenith angle    | \theta_v  |
| double m_PSI;   | //azimuth                  | \psi      |

Skyl = 0

*** Variable correlations
*** Results
#+name: sample-file
: /tmp/samples.txt

#+name: figure-file 
: scatter.png

#+name: numsamples
: 1000


#+begin_src sh :var outfile=sample-file :var samples:numsamples
otbcli_BVInputVariableGeneration -samples $samples -out $outfile
head $outfile
#+end_src

#+RESULTS:
|   MLAI |   ALA | CrownCover |    HsD |     N |   Cab |      Cdm |  CwRel |     Cbp |     Bs |
| 0.5609 | 55.93 |      1.092 |  0.142 | 1.476 | 85.26 | 0.004603 | 0.7356 |  0.4354 | 0.6643 |
|  3.851 | 56.38 |     0.5589 | 0.4101 | 1.683 | 52.17 | 0.004771 | 0.7853 |  0.1626 |  2.249 |
|  3.184 | 51.55 |     0.8362 | 0.4839 | 1.688 | 35.33 | 0.004139 | 0.7008 | 0.02641 |  2.375 |
|  3.412 | 46.72 |     0.9799 | 0.4665 |  1.34 |  36.1 | 0.005933 | 0.6999 |  0.0356 |  2.327 |
|  2.361 | 66.96 |     0.8618 | 0.3604 | 1.653 | 48.75 | 0.005816 | 0.7803 |   0.242 |  1.571 |
|   3.58 | 67.54 |     0.9746 | 0.4488 | 1.631 | 45.95 | 0.004078 | 0.7679 |  0.2375 |  2.084 |
|  3.566 | 45.79 |     0.6626 | 0.2087 | 1.405 | 63.07 | 0.004747 | 0.8075 |  0.3232 |  1.267 |
|  2.955 | 57.72 |     0.6685 |   0.26 | 1.593 | 36.52 | 0.008179 | 0.7556 |  0.4647 |  2.805 |
|  3.524 | 63.58 |     0.6787 | 0.1097 | 1.522 | 60.61 | 0.006968 | 0.7773 |  0.1248 |  2.014 |

#+begin_src sh :var outfile=sample-file figfile=figure-file
python ../src/scripts/scatterplots.py $outfile $figfile
#+end_src

[[file:scatter.png]]


** Reflectance simulation

** Mismatch estimation

** Model inversion

** BV estimation

* References

* Actions                                                          :noexport:

** TODO References Weiss & Baret
** TODO [2013-10-24 Thu 14:36] Comments  [[file:~/Dev/otb-bv/src/library/otbNeuralNetworkRegressionMachineLearningModel.h::void%20SetLayerSizes%20(const%20std::vector<unsigned%20int>%20layers)][file:~/Dev/otb-bv/src/library/otbNeuralNetworkRegressionMachineLearningModel.h::void SetLayerSizes (const std::vector<unsigned int> layers)]]
- SetLayerSizes should be virtual
- attributers shoudl be protected and not private
** TODO [2013-10-24 Thu 14:41] variables are not normalised in the regression
  [[file:~/Dev/otb-bv/src/library/otbNeuralNetworkRegressionMachineLearningModel.h::/**]]
